language: node_js
sudo: false
cache:
  bundler: true
  directories:
  - node_modules
node_js:
- '0.10'
env:
  global:
  - AWS_ACCESS_KEY_ID=AKIAIT4X4NDGM2WVL6VA
  - DOCKER_USERNAME=octoblu
  - DEPLOY_APPLICATION_NAME=flow-deploy-service
  - DEPLOY_REGION=us-west-2
  - DEPLOY_BUCKET=octoblu-deploy
  - DEPLOYMENT_GROUP=master
  - DEPLOY_KEY=flow-deploy-service/flow-deploy-service-$TRAVIS_COMMIT.zip
  - secure: y5O8Uj4IKwcrEjrFOs3rS/mxG5LB98v1wEMqjozcEP+lPelfA3jQh+U29E49bK96GzRGWLgiVq9iZDT6TQ8YqVaIRF/wPOGATv63tEo/pvCMeFENl62b4gQoBDejVHIM90jRtsyku9yciZpZQx0RBa89CPw1viW13RBfX3iSaP1Tk+K9dkykJYZQJT041UcHzLY8m+b6n3RxiFKLBZoKygTVUjtiLfkw5NiDZ5MJlXMiDmdzRzbSvSlJRfCGtGhh+LUXOZoat29+pv7G91cN34TThbGRxtR8oMQ38Bb1Ko6eez56nEEnyXHPDWRHYpdJdOGOCg2rmZaHrMVJTNkkcZdI/6XahAGlg56cQLyv++Xqy/k9mAIZn0i58uoL91mXsKsqBcpCQH76EhMvwPxdEwekEW9kbugutBuJYgBIn0RYLu52/ARHNtaIO54npedzrhuZz5t+MzAtdZlYP+gqxbyIQoapfQA+e5NaeoHIwjuVie8bY/Qng24zmrN8fuPtFHL6Td+/pPoS83W5/l9xnx1GvAqKzJY36dbSPdBEaVYCgqRL+OS4fJ/3TQPRKYqwevNEGn5PT4Wn1OEm1IykqDW5jHy/Q2ERtw16yAUjD6BgLpmsXAhiyRfqnU69yeUlqPU3rduv9aZ31jvxRi7Cz0dyF+RDZsGtFOkoDbjbUCw=
  - secure: yL7paMe0ZKjGFiN0AZ8/BYJs8IoeR2t6HP+xU3TEF8ADx/50kQe+sLs/U8MWt0d8ZG9Kz5+ccFyivnO9CRHsPUetRdMLzymaQcYy08qU2sK1TlG6wYvgR19YK/oIyzInUFE7IJESDfckJfqRUxocKV6w/m3SnjBqkescLe0ogSkBiz6zQ+LZIE7egnNZ1wG0g+81/eY8GLsFiujAiwpmVQfYFhDckVgEwPPd93B2BW8wj20Uys5sgQ5RW+mrEvylg0SCVmkQsC/qy1KGBW7OYo3+mAhXY6yVCMO3DrH+0H3vMhO+lWHZ34BhUdgcMbejDjWcwD7maSuI29X/lj1DBCdzFnF5HnkV2kndcYNfezZkW1CSDG9tE4Nk/I1QlDd+cwtUWJIpy3/mJwZqkKNHAOUYDIqlsezyNn1GdLZPmX1UoB2MtC6fZnYrLG4JNKZWiLxRdeu+FQ4/YHAB09PM2K+QXoyb2xR44RNVdmkfCCwAjKbGsK4Zw+8SF3jJIwcVX2ZsTPGWy7G0b9IAt6I59SghwUbJW0zSzVt7HM30lrYrR5x4VxhG4POsBaeI5XowsmH6gIIwad3WyDVmUJ54fxo+XxYDmHonkB4Pxtj++RPdexseEw6JdGO2x5Tbn6V5HZOmTobrtvUm3qSLbUsDgSumL62PYQyI2T78UFOht0Y=
after_success:
- .kubernetes/travis_after_success
deploy:
- provider: s3
  access_key_id: AKIAIT4X4NDGM2WVL6VA
  secret_access_key: &1
    secure: BwDhWEak16VVt7N1GcVlqdikhmjJQdaZl3a5NOL+n5tHA+PEh9TTYFN6D5Ym3bKxoSXSAQ89nmahtacOotmr70OuSdFQZYypGSxoMy8eaEq6BN2oYKRY4+/8/p2f/Q8ic33I/9i5KUoyN9LfBZTEhXWF5BIkm4jrPj62UbaFut7Vnk8T8hhY3E1i6qqQSseaBEm7G6QtSy2Rk750eFZsoBFfA0E4FFnetvOFv4szcvN3LhDcMbvU4isxw4go7MQkSSjqBVHdJOY03sK2sns/ETRGn/G5qfXdgLBvv4KQgQV5MTn/nD3z2ojkPLjTImTF/5OWixnlZiZHyw8NYmkZJstczMmsGpbcG9dkQvqO429oCHYhARq4Uf+jCV26K0pWTnKqySfodS4k+VhZgRlqAeR51FMUD49tSGpF7+5logckU3Qrq2033FoW6kDAJ7gk82RCT86ANh4cjKBxrfZzGR9jnX9iJxmrNSdf4lePXDNBXBGzPrz9z7if+JhSVn+Kn8vsmtyuWP/SmlEAJH2+FmvyRWbGlyEGbf33OEPEzZ1GfG23O0my8XI1fDgX1EVR7fhOcZbnA4CU8yTYjPLr2juQbBNMJTACNWbNrxCgxw+6zBXmQB14psZMlGYOZTW9jh6l1GqoshtyTTVDt5qwkAawz3F/sFRVzPzWbMhA8TU=
  local_dir: dpl_cd_upload
  skip_cleanup: true
  bucket: octoblu-deploy
  on:
    branch: master
- provider: codedeploy
  access_key_id: AKIAIT4X4NDGM2WVL6VA
  secret_access_key: *1
  bucket: octoblu-deploy
  key: docker-builder/flow-deploy-service-$TRAVIS_COMMIT.zip
  bundle_type: zip
  region: us-west-2
  application: docker-builder
  deployment_group: flow-deploy-service
  on:
    branch: master
