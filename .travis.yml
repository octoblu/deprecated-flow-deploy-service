language: node_js
sudo: false
cache:
  bundler: true
  directories:
  - node_modules
node_js:
- '0.10'
env:
  global:
  - AWS_ACCESS_KEY_ID=AKIAJH2D5IPIRHYJT5IA
  - DOCKER_USERNAME=octoblu
  - DEPLOY_APPLICATION_NAME=flow-deploy-service
  - DEPLOY_REGION=us-west-2
  - DEPLOY_BUCKET=octoblu-deploy
  - DEPLOYMENT_GROUP=master
  - DEPLOY_KEY=flow-deploy-service/flow-deploy-service-$TRAVIS_COMMIT.zip
  - FLOW_DEPLOY_SERVICE_UUID=f515e496-c6d5-4195-b3be-6a6fe77b3b51
  - secure: y5O8Uj4IKwcrEjrFOs3rS/mxG5LB98v1wEMqjozcEP+lPelfA3jQh+U29E49bK96GzRGWLgiVq9iZDT6TQ8YqVaIRF/wPOGATv63tEo/pvCMeFENl62b4gQoBDejVHIM90jRtsyku9yciZpZQx0RBa89CPw1viW13RBfX3iSaP1Tk+K9dkykJYZQJT041UcHzLY8m+b6n3RxiFKLBZoKygTVUjtiLfkw5NiDZ5MJlXMiDmdzRzbSvSlJRfCGtGhh+LUXOZoat29+pv7G91cN34TThbGRxtR8oMQ38Bb1Ko6eez56nEEnyXHPDWRHYpdJdOGOCg2rmZaHrMVJTNkkcZdI/6XahAGlg56cQLyv++Xqy/k9mAIZn0i58uoL91mXsKsqBcpCQH76EhMvwPxdEwekEW9kbugutBuJYgBIn0RYLu52/ARHNtaIO54npedzrhuZz5t+MzAtdZlYP+gqxbyIQoapfQA+e5NaeoHIwjuVie8bY/Qng24zmrN8fuPtFHL6Td+/pPoS83W5/l9xnx1GvAqKzJY36dbSPdBEaVYCgqRL+OS4fJ/3TQPRKYqwevNEGn5PT4Wn1OEm1IykqDW5jHy/Q2ERtw16yAUjD6BgLpmsXAhiyRfqnU69yeUlqPU3rduv9aZ31jvxRi7Cz0dyF+RDZsGtFOkoDbjbUCw=
  - secure: yL7paMe0ZKjGFiN0AZ8/BYJs8IoeR2t6HP+xU3TEF8ADx/50kQe+sLs/U8MWt0d8ZG9Kz5+ccFyivnO9CRHsPUetRdMLzymaQcYy08qU2sK1TlG6wYvgR19YK/oIyzInUFE7IJESDfckJfqRUxocKV6w/m3SnjBqkescLe0ogSkBiz6zQ+LZIE7egnNZ1wG0g+81/eY8GLsFiujAiwpmVQfYFhDckVgEwPPd93B2BW8wj20Uys5sgQ5RW+mrEvylg0SCVmkQsC/qy1KGBW7OYo3+mAhXY6yVCMO3DrH+0H3vMhO+lWHZ34BhUdgcMbejDjWcwD7maSuI29X/lj1DBCdzFnF5HnkV2kndcYNfezZkW1CSDG9tE4Nk/I1QlDd+cwtUWJIpy3/mJwZqkKNHAOUYDIqlsezyNn1GdLZPmX1UoB2MtC6fZnYrLG4JNKZWiLxRdeu+FQ4/YHAB09PM2K+QXoyb2xR44RNVdmkfCCwAjKbGsK4Zw+8SF3jJIwcVX2ZsTPGWy7G0b9IAt6I59SghwUbJW0zSzVt7HM30lrYrR5x4VxhG4POsBaeI5XowsmH6gIIwad3WyDVmUJ54fxo+XxYDmHonkB4Pxtj++RPdexseEw6JdGO2x5Tbn6V5HZOmTobrtvUm3qSLbUsDgSumL62PYQyI2T78UFOht0Y=
  - secure: okN9STJakwfiymx8K8DW7tu4JoFMHDNJg68jCBzSV+qOBAMGFjPmRlrMDw8EbRYiPoTei44Yiz94lhs0FUik5oZFr1RfA8NscOr/UcfqfQ80Vjm5StQViB4x3QFPkvHpYJkQiEMtJVekxSUtaMjphtz0JHyRpx0LPX6O/oYy9BI+kUBvV5zfstgIpCiYCMOHtNW+Vithe+fmJ2U4g0+UyzU8Nn2IH1lx62mQn4YFGyVvnJmisxhuTNX1gmA8s9GZKgJZz6tUki5tFoglt4NH1FdEP0GcVRbR6fBiPKOwSDatziSobEqlnM+uysiy14pLPDL67ll51L43dxcOErVa7wGfhUPbpTXtshm+Uh5pg3gK99odobHBXG6scpGRgiCJw7MIirn4DoUN2PrpDuMgqWVgrCZ8hrwWJ2Vk+bYDfYWotVZ4F8q+8TumfKJ5fhv0G4qu+cr7NQy5qsebP+2EE/VgPTSsHmuOtOcBzEOHyyJsEnno6o7msWJJfdYEDhaL3wMU4QI4tmO9jyfUNIfx6cLFt5UNeW6rqmEyLj1vVGdeqhYzaJ1YeZj3qwWkQ2SzKKbZOUea09CbngkJmt8Q/WEWccMmNOtzQAUtVVTWj4vcKfTJmZfou0gYQn9//BNxA88IrtuqbzQrOXrteW+e6dX7qS5Px/Qcu2ljAtmwhJY=
  - secure: IhTOh7VtCOAujF7Z3Y9nvuuAdki/dX1bt1QsWRFQj4dhwjdbRBVASnTLPp9xeOTQzwnXk/eBgRzrWRJuTaIvJyqz0nVG+CB5UM1aG1cJCUBMs1PAY0BkalLiOlX7zOlyvTrr89TvTQud5KFqQLZpYB2Wbw8q0H7YV0u4dgCIwR+7Ix2TF/s0K9Se/b/ViQfRAT62IM3/tJrRoxVYAIJeUoy3T0tLjiCleBjO4AkVRUanA+OEjUdrRtcIuNyIYkKaoCYeJSE20ssu0QeZNnOPwpTlPx545j4YrYBEWNq6xq5jStKZSEVhjUpbGy77SB+KnERHpfjF9cJZ4QsHUc5aw1cA8/kwcDAHchZmdYSEtBLrGDTeGLj9Aj34aEdC8guxXJ+ZYefin/0q0azbi+uRYiRP0IvYhjSmjQenz0+NAWSbFD4fGKaRyfeh57Kob62CXuwxG3C4ggajeUcllDr8fsKnfBSN2C1+UPLg6/l/IUg6gy+4OVTY4eSVGfgybYLDld1NEbqHZFO/b5CaGPfFksnbhqhHpa7nF2Fr7NOR4sC2z7VtV3V9+mBX+foPxLV+zeNwYVXsFCVp5adeI0Xla7CSGPMPViG/FXql/GQq6hS3lIRjI+qRsWkmkgusrZRsyMXUWjHTf70cj/9ympF/Ed4BWyTrtxuLv+R3yJu35+Q=
after_success:
- .kubernetes/travis_after_success
deploy:
- provider: s3
  access_key_id: AKIAJH2D5IPIRHYJT5IA
  secret_access_key: &1
   secure: "hHleBUX8GZIMTdPglPAV6qdW6NaZ6gqgOs6wFLzpEmwfyWQp9bxRuDAsLm8oJCppFljOKpDoadxeoMGUhq6RwU8RJzv62IlisME7BeeUEvQE8t9o9izG2X56a7MtiIwoTSZu1kUbewenhv0X6PiXfjCCf40hfAr682nXlbahj4UElb3qaigX+riTriilDTYbzZn9Ew77Sp3LZ+0gOgEh7l2aW6PkeZkBffUyHcklzflvP6R06GpK3QMYfC3wzBQLZfVS3Nl6aikTFeGNoZyUarpI+PNxKFeIHjrdAAQmS6oOyFpUma7DQBP9X/5X6UGpQ7lMrCA8pgqH+QZAYj6vQR9OBd1HjZlI8EiVZR+xjMvuUCEDqqYnG8tc4GlwAxNMFupUGPiCOi9toTMB585R6TitzKnTO6cONILZq7ygCt2Zr6MaXYEfqJBM9+qyI4mtXJ/OhtoXNh9VIUjeuLX8/kJflmIEpi+1874YaWR910xJdTasu8N1xcU4PAykVOANaCV192llIMZs6x+vLlil9GwpDk0tagDpXa/QNI56P+/NAd8DfxaaANsVyzlCe36UkMYGY4TaqAg5RQKcHUFznao1Zw5s5u6STVqknR5NMtjVBvhOOV81TYIdbo3bpVQsGwnIXk17ZIDhixTtbH8F2dizAtSEQT2f5uajBkLx2Bc="
  local_dir: dpl_cd_upload
  skip_cleanup: true
  bucket: octoblu-deploy
  on:
    branch: master
- provider: codedeploy
  access_key_id: AKIAJH2D5IPIRHYJT5IA
  secret_access_key: *1
  bucket: octoblu-deploy
  key: docker-builder/flow-deploy-service-$TRAVIS_COMMIT.zip
  bundle_type: zip
  region: us-west-2
  application: docker-builder
  deployment_group: flow-deploy-service
  on:
    branch: master
